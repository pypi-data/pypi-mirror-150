/*! For license information please see 679.8294a03c3099b43ae6ee.js.LICENSE.txt */
(self.webpackChunk_unfolded_jupyter_map_sdk=self.webpackChunk_unfolded_jupyter_map_sdk||[]).push([[679],{19679:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionType:()=>r,UnfoldedMap:()=>c,_addTileset:()=>N,addDataset:()=>O,addLayer:()=>k,createMap:()=>p,getLayerTimelineInfo:()=>L,getLayers:()=>_,getMapUrl:()=>l,getTimelineInfo:()=>h,refreshMapData:()=>M,removeDataset:()=>b,removeFilter:()=>D,removeLayer:()=>w,setFilter:()=>C,setLayerTimelineConfig:()=>A,setLayerVisibility:()=>E,setMapControlVisibility:()=>S,setTheme:()=>T,setTimelineAnimationSpeed:()=>I,setTimelineConfig:()=>g,setTimelineInterval:()=>y,setViewState:()=>f,toggleTimelineAnimation:()=>m,toggleTimelineVisibility:()=>v});var r,i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}!function(e){e.ADD_DATASET_TO_MAP="map-sdk-add-dataset-to-map",e.ADD_LAYER="map-sdk-add-layer",e.ADD_TILESET_TO_MAP="map-sdk-add-tileset-top-map",e.FILTER_CHANGED="map-sdk-filter-changed",e.GET_LAYER_TIMELINE_INFO="map-sdk-get-layer-timeline-info",e.GET_LAYERS="map-sdk-get-layers",e.GET_MAP_CONFIG="map-sdk-get-map-config",e.GET_TIMELINE_INFO="map-sdk-get-timeline-info",e.LAYER_ANIMATION_TIME_CHANGED="map-sdk-layer-animation-time-changed",e.MAP_INITIALIZED="map-sdk-initialized",e.ON_CLICK="map-sdk-on-click",e.ON_HOVER="map-sdk-on-hover",e.ON_GEOMETRY_SELECTION="map-sdk-on-geometry-selection",e.REFRESH_MAP_DATA="map-sdk-reload-map-data",e.REMOVE_DATASET_FROM_MAP="map-sdk-remove-dataset-from-map",e.REMOVE_FILTER="map-sdk-remove-filter",e.REMOVE_LAYER="map-sdk-remove-layer",e.SET_FILTER="map-sdk-set-filter",e.SET_LAYER_TIMELINE_CONFIG="map-sdk-set-layer-timeline-config",e.SET_LAYER_VISIBILITY="map-sdk-set-layer-visibility",e.SET_MAP_CONFIG="map-sdk-set-map-config",e.SET_MAP_CONTROL_VISIBILITY="map-sdk-set-map-control-visibility",e.SET_THEME="map-sdk-set-theme",e.SET_TIMELINE_INTERVAL="map-sdk-set-timeline-interval",e.SET_TIMELINE_CONFIG="map-sdk-set-timeline-config",e.SET_TIMELINE_SPEED="map-sdk-set-timeline-speed",e.SET_VIEW_STATE="map-sdk-set-view-state",e.TOGGLE_TIMELINE_ANIMATION="map-sdk-toggle-timeline-animation",e.TOGGLE_TIMELINE_VISIBILITY="map-sdk-toggle-timeline-visibility",e.TIMELINE_INTERVAL_CHANGED="map-sdk-timeline-interval-changed"}(r||(r={}));var u=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.iframe=t,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype._getPostMessageTarget=function(){return this.iframe&&this.iframe.contentWindow},t}(function(){function e(e,t){var n=this;this.onMessage=e,this.sourceClient=t.sourceClient,this.sourceServer=t.sourceServer,window.addEventListener("message",(function(e){n._onMessage(e,n.type,n.resolve,n.reject)}))}return e.prototype._getPostMessageTarget=function(){return window},e.prototype.sendMessage=function(e,t){var n=this;return new Promise((function(r,i){var o=n.sourceClient,s=function(e){var t=new Set;try{return JSON.stringify(e,(function(e,n){if("bigint"==typeof n)return{_type:"bigint",_value:n.toString()};if("object"==typeof n&&null!==n){if(t.has(n))try{return JSON.parse(JSON.stringify(n))}catch(e){return}t.add(n)}return n}))}catch(e){return null}}({type:e,source:o,data:t}),a=n._getPostMessageTarget();s&&a&&(a.postMessage(s,"*"),n.type=e,n.resolve=r,n.reject=i)}))},e.prototype._onMessage=function(e,t,n,r){var i=this.parseMessage(e);if(i){var o=i.type,s=i.data;if(this.onMessage(o,s),t&&n&&r)switch(o){case t+"-response":n(s);break;case t+"-error":r(new Error(null==s?void 0:s.message))}}},e.prototype.parseMessage=function(e){if("string"==typeof e.data){var t=function(e){try{return JSON.parse(e,(function(e,t){if(t&&"object"==typeof t&&t.hasOwnProperty("_type"))switch(t._type){case"bigint":return window.BigInt(t._value);default:return t}return t}))}catch(e){return null}}(e.data),n=t||{},r=n.type;if(n.source===this.sourceServer&&r)return t}},e}());function l(e){return"https://studio.unfolded.ai/public/"+e}var c=function(){function e(e){this.eventHandlers={},this.iframe=document.createElement("iframe"),this._transport=new u(this.iframe,this.onMessage.bind(this),{sourceClient:"unfolded-sdk-client",sourceServer:"unfolded-sdk-server"}),function(e,t){var n=t||{},r=n.id,i=void 0===r?"unfolded_iframe":r,o=n.appendToElement,s=n.appendToDocument,a=void 0===s||s,u=n.appendToId,c=void 0===u?null:u,p=n.embed,f=void 0!==p&&p,_=n.width,E=void 0===_?"100%":_,T=n.height,h=void 0===T?"100%":T,m=t.mapUUID?l(t.mapUUID):t.mapUrl;m||(m="https://studio.unfolded.ai/incognito"),f&&(m+="/embed"),e.setAttribute("src",m),e.setAttribute("id",i),e.setAttribute("width",""+E),e.setAttribute("height",""+h),e.style.width=d(E),e.style.height=d(h);var v=function(e,t,n){if(e||t){var r=e||(t?document.getElementById(t):null);if(r instanceof HTMLElement)return r}else if(n)return document.body}(o,c,a);if(v)!function(e,t,n){var r=e.querySelector&&e.querySelector("iframe#"+t);r?r.replaceWith(n):e.appendChild(n)}(v,i,e);else if(a)throw new Error("Target container element not found")}(this.iframe,e),this.setMapEventHandlers(e)}return e.prototype.setMapEventHandlers=function(e){this.eventHandlers=o(o({},this.eventHandlers),e)},e.prototype.setViewState=function(e){return this._transport.sendMessage(r.SET_VIEW_STATE,{viewState:e})},e.prototype.getLayers=function(){return this._transport.sendMessage(r.GET_LAYERS,{})},e.prototype.setLayerVisibility=function(e,t){return this._transport.sendMessage(r.SET_LAYER_VISIBILITY,{layerId:e,isVisible:t})},e.prototype.setTheme=function(e){return this._transport.sendMessage(r.SET_THEME,{theme:e})},e.prototype.getTimelineInfo=function(e){return this._transport.sendMessage(r.GET_TIMELINE_INFO,{idx:e})},e.prototype.setTimelineConfig=function(e){return this._transport.sendMessage(r.SET_TIMELINE_CONFIG,{config:e})},e.prototype.refreshMapData=function(){return this._transport.sendMessage(r.REFRESH_MAP_DATA,{})},e.prototype.getLayerTimelineInfo=function(){return this._transport.sendMessage(r.GET_LAYER_TIMELINE_INFO,{})},e.prototype.setLayerTimelineConfig=function(e){return this._transport.sendMessage(r.SET_LAYER_TIMELINE_CONFIG,{config:e})},e.prototype.setMapControlVisibility=function(e){return this._transport.sendMessage(r.SET_MAP_CONTROL_VISIBILITY,{config:e})},e.prototype._addTileset=function(e){return this._transport.sendMessage(r.ADD_TILESET_TO_MAP,{tileset:e})},e.prototype.addDataset=function(e,t){return void 0===t&&(t=!0),s(this,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return[4,this._transport.sendMessage(r.ADD_DATASET_TO_MAP,{dataset:"string"==typeof e?{uuid:e}:e,autoCreateLayers:t})];case 1:return n=i.sent(),[2,Boolean(n&&"ok"===n.status)]}}))}))},e.prototype.removeDataset=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,this._transport.sendMessage(r.REMOVE_DATASET_FROM_MAP,{uuid:e})];case 1:return t=n.sent(),[2,Boolean(t&&"ok"===t.status)]}}))}))},e.prototype.addLayer=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){return t=this._transport.sendMessage(r.ADD_LAYER,{layer:e}),[2,Boolean(t&&"ok"===t.status)]}))}))},e.prototype.removeLayer=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,this._transport.sendMessage(r.REMOVE_LAYER,{id:e})];case 1:return t=n.sent(),[2,Boolean(t&&"ok"===t.status)]}}))}))},e.prototype.setFilter=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,this._transport.sendMessage(r.SET_FILTER,{info:e})];case 1:return t=n.sent(),[2,Boolean(t&&"ok"===t.status)]}}))}))},e.prototype.removeFilter=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return[4,this._transport.sendMessage(r.REMOVE_FILTER,{id:e})];case 1:return t=n.sent(),[2,Boolean(t&&"ok"===t.status)]}}))}))},e.prototype.getMapConfig=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this._transport.sendMessage(r.GET_MAP_CONFIG,{})]}))}))},e.prototype.setMapConfig=function(e){return s(this,void 0,void 0,(function(){var t;return a(this,(function(n){return t=this._transport.sendMessage(r.SET_MAP_CONFIG,{mapConfig:e}),[2,Boolean(t&&"ok"===t.status)]}))}))},e.prototype._callSDKFunction=function(e,t){return this._transport.sendMessage(e,t)},e.prototype.onMessage=function(e,t){var n,i,o,s,a,u,l,c,d,p,f,_,E,T;switch(e){case r.MAP_INITIALIZED+"-response":null===(i=null===(n=this.eventHandlers)||void 0===n?void 0:n.onLoad)||void 0===i||i.call(n);break;case r.ON_CLICK+"-response":null===(s=null===(o=this.eventHandlers)||void 0===o?void 0:o.onClick)||void 0===s||s.call(o,t);break;case r.ON_HOVER+"-response":null===(u=null===(a=this.eventHandlers)||void 0===a?void 0:a.onHover)||void 0===u||u.call(a,t);break;case r.ON_GEOMETRY_SELECTION+"-response":null===(c=null===(l=this.eventHandlers)||void 0===l?void 0:l.onGeometrySelection)||void 0===c||c.call(l,t);break;case r.TIMELINE_INTERVAL_CHANGED+"-response":null===(p=null===(d=this.eventHandlers)||void 0===d?void 0:d.onTimelineIntervalChange)||void 0===p||p.call(d,t);break;case r.LAYER_ANIMATION_TIME_CHANGED+"-response":null===(_=null===(f=this.eventHandlers)||void 0===f?void 0:f.onLayerTimelineTimeChange)||void 0===_||_.call(f,t);break;case r.FILTER_CHANGED+"-response":null===(T=null===(E=this.eventHandlers)||void 0===E?void 0:E.onFilter)||void 0===T||T.call(E,t)}},e.prototype.render=function(e){(e||document.body).appendChild(this.iframe)},e}();function d(e){return"number"==typeof e?e+"px":e}function p(e){return new c(e)}function f(e,t){return e.setViewState(t)}function _(e){return e.getLayers()}function E(e,t,n){return e.setLayerVisibility(t,n)}function T(e,t){return e.setTheme(t)}function h(e,t){return e.getTimelineInfo(t)}function m(e,t){return e._callSDKFunction(r.TOGGLE_TIMELINE_ANIMATION,{idx:t})}function v(e,t){return e._callSDKFunction(r.TOGGLE_TIMELINE_VISIBILITY,{idx:t})}function y(e,t,n,i){return e._callSDKFunction(r.SET_TIMELINE_INTERVAL,{idx:t,startTime:n,endTime:i})}function I(e,t,n){return e._callSDKFunction(r.SET_TIMELINE_SPEED,{idx:t,speed:n})}function g(e,t){return e.setTimelineConfig(t)}function M(e){return e.refreshMapData()}function L(e){return e.getLayerTimelineInfo()}function A(e,t){return e.setLayerTimelineConfig(t)}function S(e,t){return e.setMapControlVisibility(t)}function N(e,t){return e._addTileset(t)}function O(e,t){return e.addDataset(t)}function b(e,t){return e.removeDataset(t)}function k(e,t){return e.addLayer(t)}function w(e,t){return e.removeLayer(t)}function C(e,t){return e.setFilter(t)}function D(e,t){return e.removeFilter(t)}}}]);