---
version: '3'

services:
  prometheus:
    image: docker.io/prom/prometheus
    restart: always
    volumes:
      - ./configs/prometheus.yml:/etc/prometheus/prometheus.yml
    ports:
      - 9090:9090

  # This service is currently not in use since Onionprobe already handles it's
  # own Tor process.
  #
  # This service container is also shipped with a hardcoded
  # HashedControlPassword, so please use it only fort testing purposes but not
  # in production.
  #tor:
  #  image: "rhatto/tor:1.0"
  #  build:
  #    context: .
  #    dockerfile: containers/tor/Dockerfile
  #  restart: always
  #  #ports:
  #  #  - 9050:9050
  #  #  - 9051:9051

  onionprobe:
    image: "rhatto/onionprobe:1.0"
    build:
      context: .
      dockerfile: containers/onionprobe/Dockerfile
    restart: always
    tty: true
    stdin_open: true
    volumes:
      - .:/srv/onionprobe
    ports:
      - 9091:9091
    environment:
      ONIONPROBE_CONFIG: ${ONIONPROBE_CONFIG:-/srv/onionprobe/configs/tor.yaml}
    #depends_on:
    #  - tor
