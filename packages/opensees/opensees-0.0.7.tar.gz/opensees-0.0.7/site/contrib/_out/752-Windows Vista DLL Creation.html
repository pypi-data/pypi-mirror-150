# Windows Vista DLL Creation

<p>NOTE: Before you begin, you need to obtain the developer source code.
For the executable you are using you need to obtain the correct revision
of developer code (the core can sometimes change between releases). You
use svn to obtain this (we could give the tarball, but as you are
learning to write code it is good idea to learn to use code
repositories!). The developer code can be obtained using the
following:</p>
<p>svn co -r 5540 <a
href="svn://opensees.berkeley.edu/usr/local/svn/OpenSees/trunk/DEVELOPER">svn://opensees.berkeley.edu/usr/local/svn/OpenSees/trunk/DEVELOPER</a>
OpenSeesDeveloper</p>
<p>where 5540 in this example obtains revision 5540 and the revision
number, present in all releases above 2.4.2, is shown in brackets beside
the version number.</p>
<p>The following are the <strong>34 steps</strong> needed to build a
.dll &amp; test it. This is hopefully foolproof!</p>
<p>1. Open ViualStudio</p>
<p>2. File -&gt; New Project</p>
<p>2.a Ensure VisualC++ and Win32 Project buttons are highlighted</p>
<p>3. Give it name of the <strong>New class</strong> and location of
current class files (ElasticPPcpp and
C:\???\OpenSeesDeveloper\material\cpp)</p>
<p>4. Select OK.</p>
<p>5. New windows pops up, Select Application Settings</p>
<p>6. Select DLL AND select Empty Project</p>
<p>7. Select Finish</p>
<p>a new project pops up in the workspace with class name
(ElasticPPcpp)</p>
<p>8. Right click on source files, select add Existing Item.</p>
<p>9. browse to the class file (should be up 1 directory, select it
(ElasticPPcpp.cpp)</p>
<p>10.Right click on header files, select add existing item.</p>
<p>11. browse to header file, select it (ElasticPPcpp.h)</p>
<p>12. right click on Project (ElasticPPcpp), select build.</p>
<p><strong>It fails in compilation</strong>, as cannot find file
elementAPI.h</p>
<p>13. right click on Project (ElasticPPcpp), select Properties.</p>
<p>14. select C/C++ folder icon</p>
<p>15. In Configuration pull down menu, select all Configurations</p>
<p>16. Click 3 dots to right of Additional Include Directories</p>
<p>17. In window that pops up, select folder</p>
<p>18. add to line ..\..\core (this directory contains the elementAPI.h
file .. NOTE you may need more ..\ with VisualStudio2010!).</p>
<p>19. select ok.</p>
<p>20. right click on project (ElasticPPcpp), select build</p>
<p><strong>It fails in Linking</strong>, a lot of unresolved external
symbols.</p>
<p>21. Right click on source files, select add Existing Item.</p>
<p>22. browse to the core directory (should be 1 directory up)</p>
<p>23. select all the .cpp files here</p>
<p>24. right click on Project (ElasticPPcpp), select build.</p>
<p>Now test it,</p>
<p>25. using windows finder, copy the .dll
(C:\??\OpenSeesDeveloper\material\ElasticPPCPP\Debug) into the class
directory (C:\???\OpenSeesDeveloper\material\)</p>
<p>26. run OpenSees (2.2.0) (C:\??\OpenSeesDeveloper\bin)</p>
<p>27. cd into directory containing example (cd ..\material)</p>
<p>28. source an example script containing your new command, i.e. type:
"source example1.tcl"</p>
<p>If using 32 bit application, YOU SHOULD BE DONE.</p>
<p>If using the 64bit version of OpenSees .. you need to set the
configuration to x64 from Win32 and rebuild</p>
<p>29. select the pull down manager (downward arror to right of Win32)
and select Configurtion Manager</p>
<p>30. Under the Active Solution Platforms, select the win32 Pulldown
and select the &lt;New&gt; option</p>
<p>31. x64 should pop up. select ok.</p>
<p>32. click close and rebuild.</p>
<p>Now try testing it again.</p>
<p>33. copy the .dll again. the .dll file is in a different location
(C:\??\OpenSeesDeveloper\material\ElasticPPCPP\x64\Debug)</p>
<p>34. repeat 27 and 28 again.</p>
<p>IT SHOULD RUN THE SCRIPT! .. IF IT FAILS GET MY ATTENTION.</p>
